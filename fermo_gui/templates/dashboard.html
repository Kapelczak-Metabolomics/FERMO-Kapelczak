{% extends 'base.html' %}

{% block content %}
<div class="row">
    <div class="col-xs-12 col-sm-12 col-md-4 pe-md-0 pe-sm-3">
        <div class="dropzone">
            <div class="accordion accordion-item" draggable="true" id="sample">
                <h2 class="accordion-header" id="sampleTableHeader">
                    <button class="accordion-button"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#sampleTable"
                            aria-expanded="true"
                            aria-controls="sampleTable">
                    General information
                    </button>
                </h2>
                <div id="sampleTable"
                     class="accordion-collapse collapse show"
                     aria-labelledby="sampleTableHeader">
                    <div class="accordion-body overflow-auto">
                        <table class="table table-striped table-hover">
                            <tbody>
                                {% for key in data.stats_analysis %}
                                    <tr>
                                        <td style="text-align: left;">{{ key }}</td>
                                        <td style="text-align: left;">{{ data.stats_analysis[key] }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="dropzone">
            <div class="accordion accordion-item" id="sampleInfo">
                <h2 class="accordion-header" id="sampleInfoHeader">
                    <button class="accordion-button collapsed"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#sampleInfoTable"
                            aria-expanded="false"
                            aria-controls="sampleInfoTable">
                        Sample Overview
                    </button>
                </h2>
                <div id="sampleInfoTable"
                     class="accordion-collapse collapse"
                     aria-labelledby="sampleInfoHeader">
                    <div class="accordion-body overflow-auto">
                        <table id="sampleInfoTables" class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    {% for header_value in data.stats_samples_dyn[0] %}
                                        <th>{{ header_value }}</th>
                                    {% endfor %}
                                </tr>
                            </thead>
                            <tbody>
                                {% for filename in data.stats_samples_dyn %}
                                    <tr class="select-sample"
                                        data-sample-name="{{ filename['Sample name'] }}"
                                        style="cursor: pointer;">
                                        {% for key, value in filename.items() %}
                                            <td>{{ value }}</td>
                                        {% endfor %}
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="dropzone">
            <div class="accordion accordion-item" draggable="true" id="feature">
                <h2 class="accordion-header" id="featureTableHeader">
                    <button class="accordion-button collapsed"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#featureTable"
                            aria-expanded="false"
                            aria-controls="featureTable">
                        Molecular Feature Info
                    </button>
                </h2>
                <div id="featureTable"
                     class="accordion-collapse collapse"
                     aria-labelledby="featureTableHeader">
                    <div class="accordion-body overflow-auto">
                    </div>
                </div>
            </div>
        </div>

        <div class="dropzone">
            <div class="accordion accordion-item" draggable="true" id="filter">
                <h2 class="accordion-header" id="filtersHeader">
                    <button class="accordion-button collapsed"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#filters"
                            aria-expanded="false"
                            aria-controls="filters">
                        Filters
                    </button>
                </h2>
                <div id="filters"
                     class="accordion-collapse collapse"
                     aria-labelledby="filtersHeader">
                    <div class="accordion-body overflow-auto">

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="col-xs-12 col-sm-12 col-md-8 ps-md-0 pe-sm-3">
        <div class="dropzone">
            <div class="accordion accordion-item" draggable="true" id="chromatogram">
                <h2 class="accordion-header" id="ChromatogramHeader">
                    <button class="accordion-button"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#ChromatogramBody"
                            aria-expanded="true"
                            aria-controls="ChromatogramBody">
                    Main Chromatogram
                    </button>
                </h2>
                <div id="ChromatogramBody"
                     class="accordion-collapse collapse show"
                     aria-labelledby="sampleTableHeader">
                    <div class="accordion-body overflow-auto">
                        <div class="chromDiv row-md-12">
                            <h6 id="activeSample" class="fw-bold" style="font-size: 14px;">
                                Sample: {{ data.stats_chromatogram | first }}
                            </h6>
                            <p>Click any sample in the 'Sample Overview' table to visualize its chromatogram.</p>
                            <div id="mainChromatogram"
                                 data-stats-chromatogram='{{ data.stats_chromatogram | tojson | safe }}'>
                            </div>

                        </div>
                    </div>


                </div>
            </div>
        </div>

        <div class="dropzone">
            <div class="accordion accordion-item" draggable="true" id="cyto">
                <h2 class="accordion-header" id="cytoscapeHeader">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cytoscape" aria-expanded="true" aria-controls="Cytoscape">
                        Cytoscape
                    </button>
                </h2>
                <div class="accordion-collapse collapse" id="cytoscape" aria-labelledby="CytoscapeHeader">
                    <div class="accordion-body overflow-auto">
                        <h6 class="fw-bold"> Cytoscape view - spectral similarity networking</h6>
                        {% if cytoscape_message %}
                            <p class="text-danger">{{ cytoscape_message }}</p>
                        {% endif %}
                        <div id="cy"></div>
                        <div class="d-inline-flex mt-2">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-xs-12 col-sm-12 col-md-4">
        <div class="dropzone"></div>
    </div>
    <div class="col-xs-12 col-sm-12 col-md-4">
        <div class="dropzone"></div>
    </div>
    <div class="col-xs-12 col-sm-12 col-md-4">
        <div class="dropzone"></div>
    </div>
</div>
<div class="row">
    <div class="col-xs-12 col-sm-12 col-md-6">
        <div class="dropzone"></div>
    </div>
    <div class="col-xs-12 col-sm-12 col-md-6">
        <div class="dropzone"></div>
    </div>
</div>



<script type="text/javascript" src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/chromatogram.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/plotly-2.18.2.min.js') }}"></script>
<script>
    var statsChromatogram = {{ data.stats_chromatogram | tojson | safe }};
</script>

{% endblock %}